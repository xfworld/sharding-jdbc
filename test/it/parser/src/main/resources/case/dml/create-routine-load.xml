<?xml version="1.0" encoding="UTF-8"?>
<!--
  ~ Licensed to the Apache Software Foundation (ASF) under one or more
  ~ contributor license agreements.  See the NOTICE file distributed with
  ~ this work for additional information regarding copyright ownership.
  ~ The ASF licenses this file to You under the Apache License, Version 2.0
  ~ (the "License"); you may not use this file except in compliance with
  ~ the License.  You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<sql-parser-test-cases>
    <create-routine-load sql-case-id="create_routine_load_simple" job-name="test1">
        <owner name="example_db" start-index="20" stop-index="29" />
        <job-property key="desired_concurrent_number" value="3" start-index="49" stop-index="79" />
        <data-source>KAFKA</data-source>
        <data-source-property key="kafka_broker_list" value="broker1:9092" start-index="94" stop-index="129" />
    </create-routine-load>
    
    <create-routine-load sql-case-id="create_routine_load_with_table" job-name="test1">
        <owner name="example_db" start-index="20" stop-index="29" />
        <table name="example_tbl" start-index="40" stop-index="50" />
        <job-property key="desired_concurrent_number" value="3" start-index="64" stop-index="94" />
        <data-source>KAFKA</data-source>
        <data-source-property key="kafka_broker_list" value="broker1:9092" start-index="109" stop-index="144" />
        <data-source-property key="kafka_topic" value="my_topic" start-index="147" stop-index="172" />
    </create-routine-load>
    
    <create-routine-load sql-case-id="create_routine_load_with_columns" job-name="test1" column-separator=",">
        <owner name="example_db" start-index="20" stop-index="29" />
        <table name="example_tbl" start-index="40" stop-index="50" />
        <column-mapping start-index="87" stop-index="88">
            <column name="k1" start-index="87" stop-index="88" />
        </column-mapping>
        <column-mapping start-index="91" stop-index="92">
            <column name="k2" start-index="91" stop-index="92" />
        </column-mapping>
        <column-mapping start-index="95" stop-index="96">
            <column name="k3" start-index="95" stop-index="96" />
        </column-mapping>
        <job-property key="desired_concurrent_number" value="3" start-index="111" stop-index="141" />
        <data-source>KAFKA</data-source>
        <data-source-property key="kafka_broker_list" value="broker1:9092" start-index="156" stop-index="191" />
        <data-source-property key="kafka_topic" value="my_topic" start-index="194" stop-index="219" />
    </create-routine-load>
    
    <create-routine-load sql-case-id="create_routine_load_with_where" job-name="test1">
        <owner name="example_db" start-index="20" stop-index="29" />
        <table name="example_tbl" start-index="40" stop-index="50" />
        <column-mapping start-index="60" stop-index="61">
            <column name="k1" start-index="60" stop-index="61" />
        </column-mapping>
        <column-mapping start-index="64" stop-index="65">
            <column name="k2" start-index="64" stop-index="65" />
        </column-mapping>
        <column-mapping start-index="68" stop-index="69">
            <column name="k3" start-index="68" stop-index="69" />
        </column-mapping>
        <where start-index="73" stop-index="108">
            <expr>
                <binary-operation-expression start-index="79" stop-index="108">
                    <left>
                        <binary-operation-expression start-index="79" stop-index="86">
                            <left>
                                <column name="k1" start-index="79" stop-index="80" />
                            </left>
                            <operator>&gt;</operator>
                            <right>
                                <literal-expression value="100" start-index="84" stop-index="86" />
                            </right>
                        </binary-operation-expression>
                    </left>
                    <operator>and</operator>
                    <right>
                        <binary-operation-expression start-index="92" stop-index="108">
                            <left>
                                <column name="k2" start-index="92" stop-index="93" />
                            </left>
                            <operator>LIKE</operator>
                            <right>
                                <list-expression start-index="100" stop-index="108">
                                    <items>
                                        <literal-expression value="%doris%" start-index="100" stop-index="108" />
                                    </items>
                                </list-expression>
                            </right>
                        </binary-operation-expression>
                    </right>
                </binary-operation-expression>
            </expr>
        </where>
        <job-property key="max_batch_interval" value="20" start-index="122" stop-index="148" />
        <data-source>KAFKA</data-source>
        <data-source-property key="kafka_broker_list" value="broker1:9092" start-index="163" stop-index="198" />
        <data-source-property key="kafka_topic" value="my_topic" start-index="201" stop-index="226" />
    </create-routine-load>
    
    <create-routine-load sql-case-id="create_routine_load_with_merge" job-name="test1" merge-type="MERGE">
        <owner name="example_db" start-index="20" stop-index="29" />
        <table name="example_tbl" start-index="40" stop-index="50" />
        <column-mapping start-index="71" stop-index="72">
            <column name="k1" start-index="71" stop-index="72" />
        </column-mapping>
        <column-mapping start-index="75" stop-index="76">
            <column name="k2" start-index="75" stop-index="76" />
        </column-mapping>
        <column-mapping start-index="79" stop-index="80">
            <column name="k3" start-index="79" stop-index="80" />
        </column-mapping>
        <column-mapping start-index="83" stop-index="84">
            <column name="v1" start-index="83" stop-index="84" />
        </column-mapping>
        <column-mapping start-index="87" stop-index="88">
            <column name="v2" start-index="87" stop-index="88" />
        </column-mapping>
        <column-mapping start-index="91" stop-index="92">
            <column name="v3" start-index="91" stop-index="92" />
        </column-mapping>
        <where start-index="96" stop-index="131">
            <expr>
                <binary-operation-expression start-index="102" stop-index="131">
                    <left>
                        <binary-operation-expression start-index="102" stop-index="109">
                            <left>
                                <column name="k1" start-index="102" stop-index="103" />
                            </left>
                            <operator>&gt;</operator>
                            <right>
                                <literal-expression value="100" start-index="107" stop-index="109" />
                            </right>
                        </binary-operation-expression>
                    </left>
                    <operator>and</operator>
                    <right>
                        <binary-operation-expression start-index="115" stop-index="131">
                            <left>
                                <column name="k2" start-index="115" stop-index="116" />
                            </left>
                            <operator>LIKE</operator>
                            <right>
                                <list-expression start-index="123" stop-index="131">
                                    <items>
                                        <literal-expression value="%doris%" start-index="123" stop-index="131" />
                                    </items>
                                </list-expression>
                            </right>
                        </binary-operation-expression>
                    </right>
                </binary-operation-expression>
            </expr>
        </where>
        <delete-on start-index="151" stop-index="158">
            <binary-operation-expression start-index="144" stop-index="151">
                <left>
                    <column name="v3" start-index="144" stop-index="145" />
                </left>
                <operator>&gt;</operator>
                <right>
                    <literal-expression value="100" start-index="149" stop-index="151" />
                </right>
            </binary-operation-expression>
        </delete-on>
        <job-property key="max_batch_interval" value="20" start-index="165" stop-index="191" />
        <data-source>KAFKA</data-source>
        <data-source-property key="kafka_broker_list" value="broker1:9092" start-index="206" stop-index="241" />
        <data-source-property key="kafka_topic" value="my_topic" start-index="244" stop-index="269" />
        <data-source-property key="kafka_partitions" value="0,1,2,3" start-index="272" stop-index="301" />
        <data-source-property key="kafka_offsets" value="101,0,0,200" start-index="304" stop-index="334" />
    </create-routine-load>
    
    <create-routine-load sql-case-id="create_routine_load_with_order_by" job-name="test_job" column-separator=",">
        <owner name="example_db" start-index="20" stop-index="29" />
        <table name="example_tbl" start-index="43" stop-index="53" />
        <column-mapping start-index="90" stop-index="91">
            <column name="k1" start-index="90" stop-index="91" />
        </column-mapping>
        <column-mapping start-index="93" stop-index="94">
            <column name="k2" start-index="93" stop-index="94" />
        </column-mapping>
        <column-mapping start-index="96" stop-index="110">
            <column name="source_sequence" start-index="96" stop-index="110" />
        </column-mapping>
        <column-mapping start-index="112" stop-index="113">
            <column name="v1" start-index="112" stop-index="113" />
        </column-mapping>
        <column-mapping start-index="115" stop-index="116">
            <column name="v2" start-index="115" stop-index="116" />
        </column-mapping>
        <order-by>
            <column-item name="source_sequence" start-index="129" stop-index="143" />
        </order-by>
        <job-property key="desired_concurrent_number" value="3" start-index="157" stop-index="187" />
        <data-source>KAFKA</data-source>
        <data-source-property key="kafka_broker_list" value="broker1:9092" start-index="202" stop-index="237" />
        <data-source-property key="kafka_topic" value="my_topic" start-index="240" stop-index="265" />
    </create-routine-load>
    
    <create-routine-load sql-case-id="create_routine_load_with_comment" job-name="test1" comment="Test routine load job">
        <owner name="example_db" start-index="20" stop-index="29" />
        <table name="example_tbl" start-index="40" stop-index="50" />
        <job-property key="desired_concurrent_number" value="3" start-index="64" stop-index="94" />
        <data-source>KAFKA</data-source>
        <data-source-property key="kafka_broker_list" value="broker1:9092" start-index="109" stop-index="144" />
        <data-source-property key="kafka_topic" value="my_topic" start-index="147" stop-index="172" />
    </create-routine-load>
    
    <create-routine-load sql-case-id="create_routine_load_comprehensive" job-name="name" merge-type="MERGE" column-separator="," comment="test">
        <owner name="demo_db" start-index="20" stop-index="26" />
        <table name="demo_tbl" start-index="36" stop-index="43" />
        <column-mapping start-index="92" stop-index="93">
            <column name="id" start-index="92" stop-index="93" />
        </column-mapping>
        <column-mapping start-index="96" stop-index="99">
            <column name="name" start-index="96" stop-index="99" />
        </column-mapping>
        <column-mapping start-index="102" stop-index="106">
            <column name="score" start-index="102" stop-index="106" />
        </column-mapping>
        <column-mapping start-index="109" stop-index="119">
            <column name="create_time" start-index="109" stop-index="119" />
        </column-mapping>
        <partition name="p202601" start-index="169" stop-index="175" />
        <partition name="p202602" start-index="178" stop-index="184" />
        <where start-index="123" stop-index="155">
            <expr>
                <binary-operation-expression start-index="129" stop-index="155">
                    <left>
                        <column name="create_time" start-index="129" stop-index="139" />
                    </left>
                    <operator>&gt;=</operator>
                    <right>
                        <literal-expression value="2026-01-01" start-index="144" stop-index="155" />
                    </right>
                </binary-operation-expression>
            </expr>
        </where>
        <delete-on start-index="198" stop-index="208">
            <binary-operation-expression start-index="198" stop-index="208">
                <left>
                    <column name="score" start-index="198" stop-index="202" />
                </left>
                <operator>&gt;</operator>
                <right>
                    <literal-expression value="100" start-index="206" stop-index="208" />
                </right>
            </binary-operation-expression>
        </delete-on>
        <order-by>
            <column-item name="create_time" start-index="220" stop-index="230" />
        </order-by>
        <job-property key="desired_concurrent_number" value="5" start-index="244" stop-index="276" />
        <job-property key="max_batch_interval" value="30" start-index="279" stop-index="305" />
        <job-property key="max_batch_rows" value="500000" start-index="308" stop-index="334" />
        <data-source>KAFKA</data-source>
        <data-source-property key="kafka_broker_list" value="broker1:9092,broker2:9092,broker3:9092" start-index="349" stop-index="410" />
        <data-source-property key="kafka_topic" value="demo_topic" start-index="413" stop-index="440" />
        <data-source-property key="kafka_partitions" value="0,1,2,3" start-index="443" stop-index="472" />
    </create-routine-load>
    
    <create-routine-load sql-case-id="create_routine_load_with_preceding_filter" job-name="test1">
        <owner name="example_db" start-index="20" stop-index="29" />
        <table name="example_tbl" start-index="40" stop-index="50" />
        <column-mapping start-index="60" stop-index="61">
            <column name="k1" start-index="60" stop-index="61" />
        </column-mapping>
        <column-mapping start-index="64" stop-index="65">
            <column name="k2" start-index="64" stop-index="65" />
        </column-mapping>
        <column-mapping start-index="68" stop-index="69">
            <column name="k3" start-index="68" stop-index="69" />
        </column-mapping>
        <preceding-filter start-index="90" stop-index="95">
            <binary-operation-expression start-index="90" stop-index="95">
                <left>
                    <column name="k1" start-index="90" stop-index="91" />
                </left>
                <operator>=</operator>
                <right>
                    <literal-expression value="1" start-index="95" stop-index="95" />
                </right>
            </binary-operation-expression>
        </preceding-filter>
        <job-property key="desired_concurrent_number" value="3" start-index="109" stop-index="139" />
        <data-source>KAFKA</data-source>
        <data-source-property key="kafka_broker_list" value="broker1:9092" start-index="154" stop-index="189" />
        <data-source-property key="kafka_topic" value="my_topic" start-index="192" stop-index="217" />
    </create-routine-load>

    <create-routine-load sql-case-id="create_routine_load_with_column_mapping" job-name="test1" column-separator=",">
        <owner name="example_db" start-index="20" stop-index="29" />
        <table name="example_tbl" start-index="40" stop-index="50" />
        <column-mapping start-index="87" stop-index="88">
            <column name="k1" start-index="87" stop-index="88" />
        </column-mapping>
        <column-mapping start-index="91" stop-index="92">
            <column name="k2" start-index="91" stop-index="92" />
        </column-mapping>
        <column-mapping start-index="95" stop-index="96">
            <column name="k3" start-index="95" stop-index="96" />
        </column-mapping>
        <column-mapping start-index="99" stop-index="100">
            <column name="v1" start-index="99" stop-index="100" />
        </column-mapping>
        <column-mapping start-index="103" stop-index="104">
            <column name="v2" start-index="103" stop-index="104" />
        </column-mapping>
        <column-mapping start-index="107" stop-index="119">
            <column name="v3" start-index="107" stop-index="108" />
            <mapping-expr>
                <binary-operation-expression start-index="112" stop-index="119">
                    <left>
                        <column name="k1" start-index="112" stop-index="113" />
                    </left>
                    <operator>*</operator>
                    <right>
                        <literal-expression value="100" start-index="117" stop-index="119" />
                    </right>
                </binary-operation-expression>
            </mapping-expr>
        </column-mapping>
        <column-mapping start-index="122" stop-index="153">
            <column name="dt" start-index="122" stop-index="123" />
            <mapping-expr>
                <function start-index="127" stop-index="153" function-name="from_unixtime" text="from_unixtime(ts, '%Y%m%d')">
                    <parameter>
                        <column name="ts" start-index="141" stop-index="142" />
                    </parameter>
                    <parameter>
                        <literal-expression value="%Y%m%d" start-index="145" stop-index="152" />
                    </parameter>
                </function>
            </mapping-expr>
        </column-mapping>
        <job-property key="desired_concurrent_number" value="3" start-index="168" stop-index="198" />
        <data-source>KAFKA</data-source>
        <data-source-property key="kafka_broker_list" value="broker1:9092" start-index="213" stop-index="248" />
        <data-source-property key="kafka_topic" value="my_topic" start-index="251" stop-index="276" />
    </create-routine-load>
</sql-parser-test-cases>
