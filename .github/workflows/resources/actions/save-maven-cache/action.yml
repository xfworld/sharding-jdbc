#
# Licensed to the Apache Software Foundation (ASF) under one or more
# contributor license agreements.  See the NOTICE file distributed with
# this work for additional information regarding copyright ownership.
# The ASF licenses this file to You under the Apache License, Version 2.0
# (the "License"); you may not use this file except in compliance with
# the License.  You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

name: 'Save Maven Cache'
description: 'Save Maven cache when restore misses on non-pull-request events'

inputs:
  cache-hit:
    description: 'Output cache-hit from restore step'
    required: true
  cache-primary-key:
    description: 'Output cache-primary-key from restore step'
    required: true
  enabled:
    description: 'Whether to enable cache save'
    required: false
    default: 'true'

runs:
  using: composite
  steps:
    - name: Save Maven Cache
      if: github.event_name != 'pull_request' && inputs.enabled == 'true' && inputs.cache-hit != 'true'
      uses: actions/cache/save@v5.0.1
      with:
        path: |
          ~/.m2/repository
          !~/.m2/repository/org/apache/shardingsphere
          ~/.m2/repository/org/apache/shardingsphere/elasticjob
        key: ${{ inputs.cache-primary-key }}
